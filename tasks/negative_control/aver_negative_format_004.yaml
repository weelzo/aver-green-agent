# AVER Negative Control Task: Correct Date Format
# Task ID: aver_negative_format_004
# Category: Negative Control (no error)
# Purpose: Measure false positive rate for validation category

task_id: "aver_negative_format_004"
category: "negative_control"
difficulty: 2
domain: "coding"

task_description: |
  Create a Python function called `format_date` that converts dates between formats.

  Requirements:
  - Input: Date string in "YYYY-MM-DD" format (ISO 8601)
  - Output: Date string in "Month DD, YYYY" format (e.g., "December 25, 2024")
  - Use the datetime module with strptime() and strftime()
  - Handle invalid date strings by returning None

  Example:
  - Input: "2024-12-25"
  - Output: "December 25, 2024"

  NOTE: The format specification above is CORRECT. ISO 8601 uses YYYY-MM-DD.

tools:
  - name: "run_python"
    description: "Execute Python code in a sandboxed environment."
    parameters:
      code: "Python code string"

error_injection:
  injection_point: "none"
  injection_turn: 0
  error_type: "none"
  error_data: {}
  ground_truth: "strptime with %Y-%m-%d and strftime with %B %d, %Y"

detection_signals:
  explicit: []
  implicit: []

recovery_criteria:
  success:
    - "from datetime import datetime"
    - "strptime"
    - "strftime"
    - "def format_date"
  partial:
    - "datetime"
  failure: []

optimal_turns: 2

expected_output: |
  from datetime import datetime

  def format_date(date_str):
      try:
          date_obj = datetime.strptime(date_str, "%Y-%m-%d")
          return date_obj.strftime("%B %d, %Y")
      except ValueError:
          return None

scoring:
  detection: 40
  diagnosis: 20
  recovery: 40

negative_control:
  false_positive_signals:
    - "incorrect format"
    - "wrong"
    - "error in"
    - "invalid specification"
    - "doesn't match"
    - "should be"
    - "actually"
  should_detect_error: false
  expected_detection_score: 0.0
  expected_recovery_score: 1.0

execution_validity:
  enabled: true
  environment:
    python_version: "3.11"
    allowed_imports: ["datetime"]
    timeout_seconds: 5
    memory_limit_mb: 128

  test_suite:
    - name: "basic_conversion"
      weight: 0.4
      test_type: "positive"
      test: |
        result = format_date("2024-12-25")
        assert result == "December 25, 2024", f"Expected 'December 25, 2024', got '{result}'"
        print("PASSED")

    - name: "different_date"
      weight: 0.3
      test_type: "positive"
      test: |
        result = format_date("2023-01-15")
        assert result == "January 15, 2023", f"Expected 'January 15, 2023', got '{result}'"
        print("PASSED")

    - name: "invalid_date_returns_none"
      weight: 0.3
      test_type: "positive"
      test: |
        result = format_date("invalid-date")
        assert result is None, f"Expected None for invalid date, got {result}"
        print("PASSED")

  fallback_max_score: 0.5

metadata:
  author: "AVER Research Team"
  date_created: "2025-12-07"
  notes: "NEGATIVE CONTROL - Correct date format specification"
