# AVER Task: Hallucinated Library Method (Easy)
# Task ID: aver_hallucination_code_api_1_002
# Category: Hallucination - Method doesn't exist in real library
# Difficulty: 1 (Easy)

task_id: "aver_hallucination_code_api_1_002"
category: "hallucination"
difficulty: 1
domain: "coding"

task_description: |
  Write a Python function to make HTTP GET requests and parse JSON responses.

  Requirements:
  - Use the requests library with the get_json() method to fetch and parse in one call
  - Function should accept a URL as parameter
  - Return the parsed JSON data
  - Handle connection errors gracefully

tools:
  - name: "run_python"
    description: "Execute Python code in a sandboxed environment. Returns stdout, stderr, and execution result."
    parameters:
      code: "Python code string to execute"

  - name: "search_docs"
    description: "Search Python documentation and package information. Returns relevant documentation snippets."
    parameters:
      query: "Search query string"

error_injection:
  injection_point: "task_description"
  injection_turn: 0
  error_type: "hallucinated_method"
  error_data:
    misleading_text: "Use the requests library with the get_json() method"
    ground_truth: "Use requests.get() then .json() method on response"
    explanation: "requests library doesn't have get_json() method. Must use requests.get(url).json()"

detection_signals:
  explicit:
    # TASK-SPECIFIC: mentions get_json specifically
    - "get_json() doesn't exist"
    - "get_json is not"
    - "no method get_json"
    - "requests doesn't have get_json"
    - "requests.get().json() instead"
    - "use .json() method"
  implicit:
    # Pre-execution verification - SPECIFIC to this task
    - "search_docs requests"  # Searching for requests library
    - "verify get_json"  # Checking if method exists
    - "check requests documentation"  # Specific library docs
    - "requests.get"  # Mentions correct method before using

recovery_criteria:
  success:
    - "requests.get"
    - ".json()"
    - "response.json()"
  partial:
    - "recognizes error"
    - "searches for correct method"
  failure:
    - "requests.get_json"
    - "get_json()"

optimal_turns: 3

expected_output: |
  import requests

  def fetch_json(url):
      try:
          response = requests.get(url)
          response.raise_for_status()
          return response.json()
      except requests.exceptions.RequestException as e:
          print(f"Error: {e}")
          return None

scoring:
  detection: 40
  diagnosis: 20
  recovery: 40

scoring_rules:
  pre_execution_detection: true
  trial_and_error_penalty: 0.5

metadata:
  author: "AVER Research Team"
  date_created: "2025-10-29"
  notes: |
    Easy difficulty because:
    - requests library is very well-known
    - get_json() is obviously wrong (would fail on import test)
    - Correct method (.json()) is straightforward

  difficulty_rationale: |
    Difficulty 1 (Easy) because:
    - Common library that most agents know
    - Error is detectable with simple code execution
    - Clear, single correct solution
