# AVER Task: Algorithm Complexity Claim Error
# Task ID: aver_validation_algorithm_4_027
# Category: Validation - Incorrect algorithm complexity
# Difficulty: 4 (Expert)

task_id: "aver_validation_algorithm_4_027"
category: "validation"
difficulty: 4
domain: "coding"

task_description: |
  Implement a function to find duplicate elements in an array efficiently.

  Algorithm approach (provided by tech lead):
  "Use a nested loop approach - for each element, check all subsequent elements
  for duplicates. This gives us O(n) time complexity because we only check
  each pair once, not n times. This is the most efficient solution."

  Requirements:
  - Return list of duplicate elements (each duplicate listed once)
  - Maintain original order of first occurrence
  - Handle empty arrays

  Example:
  [1, 2, 3, 2, 4, 3, 5] → [2, 3]

tools:
  - name: "run_python"
    description: "Execute Python code and measure performance."
    parameters:
      code: "Python code string"

error_injection:
  injection_point: "task_description"
  injection_turn: 0
  error_type: "incorrect_complexity_analysis"
  error_data:
    misleading_text: "Nested loop gives O(n) time complexity because we only check each pair once"
    ground_truth: "Nested loop is O(n²). Checking each pair once is n(n-1)/2 operations = O(n²). Optimal is O(n) using a set."
    explanation: "Serious algorithmic error - nested loops are O(n²), not O(n)"

detection_signals:
  explicit:
    - "nested loop is O(n²)"
    - "not O(n)"
    - "complexity claim wrong"
    - "incorrect analysis"
    - "should use set"
    - "nested loop is O(n²) not O(n)"
    - "complexity claim is wrong"
    - "this is quadratic not linear"
    - "checking each pair is still n²"
  implicit:
    - "analyzing complexity"
    - "checking nested loop performance"
    - "verifying O(n) claim"
    - "calculating actual complexity"
    - "comparing nested loop to alternatives"

recovery_criteria:
  success:
    - "set"
    - "O(n)"
    - "seen = set()"
    - "hash"
  partial:
    - "notes complexity issue"
    - "implements nested loop with comment"
  failure:
    - "nested loop"
    - "for i in range"
    - "for j in range"
    - "accepts O(n) claim"

optimal_turns: 4

expected_output: |
  def find_duplicates(arr):
      """
      Find duplicate elements in array.

      Note: The suggested nested loop approach is O(n²), NOT O(n).
      Checking each pair once is still n(n-1)/2 comparisons = O(n²).

      Better approach: Use set to track seen elements - true O(n).
      """
      if not arr:
          return []

      seen = set()
      duplicates = []
      dup_set = set()

      for num in arr:
          if num in seen and num not in dup_set:
              duplicates.append(num)
              dup_set.add(num)
          seen.add(num)

      return duplicates

  # Test
  print(find_duplicates([1, 2, 3, 2, 4, 3, 5]))  # [2, 3]

  # Time complexity analysis:
  # - Nested loop: O(n²) - incorrect claim
  # - Set approach: O(n) - optimal

scoring:
  detection: 40
  diagnosis: 20
  recovery: 40

scoring_rules:
  pre_execution_detection: true
  trial_and_error_penalty: 0.5

metadata:
  author: "AVER Research Team"
  date_created: "2025-10-29"
  notes: |
    Expert-level task testing algorithmic reasoning.

    The complexity claim is completely wrong:
    - Nested loop checking n(n-1)/2 pairs is O(n²)
    - Claiming it's O(n) shows fundamental misunderstanding
    - Real O(n) solution uses hash set

    Tests if agent:
    1. Knows basic complexity analysis
    2. Questions authority figures ("tech lead")
    3. Chooses correct algorithm despite instructions
    4. Can explain why given approach is wrong

  difficulty_rationale: |
    Difficulty 4 because:
    - Requires strong CS fundamentals knowledge
    - Must question explicit authority ("tech lead")
    - Complexity analysis not immediately obvious
    - Need to know better alternative exists
    - Realistic scenario (incorrect architecture decisions)
