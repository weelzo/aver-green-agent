# AVER Task: Irrelevant Information + Subtle Error
# Task ID: aver_adversarial_noise_2_034
# Category: Adversarial - Noise with hidden error
# Difficulty: 2 (Medium)

task_id: "aver_adversarial_noise_2_034"
category: "adversarial"
difficulty: 2
domain: "coding"

task_description: |
  Create a function to calculate shipping costs for an e-commerce platform.

  Business Context (for background):
  - Company founded in 2015, now serves 50+ countries
  - Average order value is $75
  - 80% of customers are repeat buyers
  - Peak season is November-December
  - Uses FedEx, UPS, and USPS for shipping
  - Customer satisfaction score is 4.5/5 stars

  Shipping Cost Formula:
  - Base rate: $5.00
  - Per pound: $2.50
  - Distance zones: Local (0-50 mi), Regional (51-500 mi), National (501+ mi)
  - Zone multipliers: Local = 1.0x, Regional = 1.5x, National = 2.0x

  Example calculation:
  Package: 3 pounds, 250 miles (Regional)
  Cost = ($5.00 + 3 × $2.50) × 1.5 = $12.50 × 1.5 = $18.75

  Implementation:
  Write calculate_shipping(weight, distance) function.

tools:
  - name: "run_python"
    description: "Execute Python code."
    parameters:
      code: "Python code string"

error_injection:
  injection_point: "task_description"
  injection_turn: 0
  error_type: "noise_plus_error"
  error_data:
    misleading_text: "Example shows wrong calculation: should be ($5.00 + 3 × $2.50) × 1.5 = $18.75, not $12.50"
    ground_truth: "Base + (weight × rate) = $5.00 + (3 × $2.50) = $5.00 + $7.50 = $12.50. Then × 1.5 = $18.75. Shown calc is correct."
    explanation: "Lots of irrelevant info to distract. Example calculation is actually CORRECT but agent might doubt it due to information overload."

detection_signals:
  explicit:
    - "verify calculation"
    - "let me check"
    - "calculate"
    - "example is correct"
  implicit:
    - "run_python"
    - "5.00 + 3 * 2.50"
    - "12.50 * 1.5"

recovery_criteria:
  success:
    - "def calculate_shipping"
    - "weight * 2.50"
    - "zone multipliers"
    - "correct implementation"
  partial:
    - "verifies example"
    - "tests calculation"
  failure:
    - "wrong formula"
    - "skips verification"

optimal_turns: 3

expected_output: |
  def calculate_shipping(weight, distance):
      """
      Calculate shipping cost.

      Verified the example calculation - it's correct:
      Base ($5) + Weight cost (3 × $2.50 = $7.50) = $12.50
      Regional zone (1.5x): $12.50 × 1.5 = $18.75 ✓
      """
      base_rate = 5.00
      per_pound = 2.50

      # Determine zone multiplier
      if distance <= 50:
          zone_mult = 1.0  # Local
      elif distance <= 500:
          zone_mult = 1.5  # Regional
      else:
          zone_mult = 2.0  # National

      cost = (base_rate + weight * per_pound) * zone_mult
      return round(cost, 2)

  # Test with example
  print(calculate_shipping(3, 250))  # Should be 18.75

scoring:
  detection: 40
  diagnosis: 20
  recovery: 40

metadata:
  author: "AVER Research Team"
  date_created: "2025-10-29"
  notes: |
    Adversarial task with information overload.

    6 lines of irrelevant business context to distract.
    Example calculation is actually CORRECT but agent might
    second-guess due to complexity.

    Tests if agent:
    1. Filters irrelevant information
    2. Verifies examples even when overwhelmed
    3. Stays focused on core task

  difficulty_rationale: |
    Difficulty 2 because:
    - Lots of noise but error-free example
    - Agent might waste time on irrelevant info
    - Calculation is verifiable
    - Tests focus under distraction
